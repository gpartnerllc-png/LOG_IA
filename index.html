<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
   <link rel='icon' type='image/png' href='https://images.yampi.me/assets/stores/droppfy/uploads/icon/65f3d8c635540.png'>
    <link rel='apple-touch-icon' href='https://images.yampi.me/assets/stores/droppfy/uploads/icon/65f3d8c635540.png'>
    <base href="https://cws.correios.com.br/">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Droppfy | AI Logistics Global</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: #0f172a; color: #f8fafc; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .ai-glow { box-shadow: 0 0 20px rgba(56, 189, 248, 0.2); }
        input, select { transition: all 0.2s ease; }
        input:focus { border-color: #38bdf8 !important; box-shadow: 0 0 10px rgba(56, 189, 248, 0.2); }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <header class="flex justify-between items-center mb-8 pb-6 border-b border-slate-700">
            <div>
                <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-400 to-emerald-400 bg-clip-text text-transparent">
                    DROPPFY LOGISTICS AI
                </h1>
                <p class="text-slate-400 text-sm">O Melhor Pre√ßo de Envio √© com a Droppfy</p>
            </div>
            <div class="text-right">
    <span class="px-3 py-1 rounded-full bg-emerald-500/20 text-emerald-400 text-xs font-mono">SISTEMA ATIVO</span>
    <p class="text-xs text-slate-500 mt-1">
        Status: <span id="currentDate">--/--/----</span> - <span id="currentTime" class="font-bold text-slate-300">00:00:00</span>
    </p>
</div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="glass p-6 rounded-2xl ai-glow">
                <h2 class="text-xl font-semibold mb-4 flex items-center">
                    <span class="mr-2">üìç</span> Destina√ß√£o Autom√°tica
                </h2>
                <form id="formSandx" onsubmit="processarLogistica(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-[10px] text-slate-400 mb-1 uppercase tracking-wider">CEP de Origem</label>
                            <input type="text" id="cepOrigem" name="cepOrigem" value="01001-000" class="w-full bg-slate-800 border border-slate-600 rounded-lg p-3 outline-none">
                        </div>
                        <div>
                            <label class="block text-[10px] text-slate-400 mb-1 uppercase tracking-wider">CEP de Destino</label>
                            <input type="text" id="cepDestino" name="cepDestino" placeholder="00000-000" required class="w-full bg-slate-800 border border-slate-600 rounded-lg p-3 outline-none">
                        </div>
                        <div>
                            <label class="block text-[10px] text-slate-400 mb-1 uppercase tracking-wider">Servi√ßo Priorit√°rio</label>
                            <select id="servico" name="servico" class="w-full bg-slate-800 border border-slate-600 rounded-lg p-3 outline-none">
                                <option value="04014">SEDEX (Fast Delivery)</option>
                                <option value="04510">PAC (Economic)</option>
                                <option value="04227">Mini Envios</option>
                            </select>
                        </div>
                    </div>
            </div>

            <div class="glass p-6 rounded-2xl">
                <h2 class="text-xl font-semibold mb-4 flex items-center">
                    <span class="mr-2">üì¶</span> Droppfy Packing
                </h2>
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="p-4 bg-slate-800/50 rounded-xl border border-blue-500/30 text-center">
                        <p class="text-[10px] text-blue-400 uppercase">Sugest√£o de Caixa</p>
                        <p class="font-bold text-sm" id="ai-box-suggestion">Caixa Tipo M</p>
                    </div>
                    <div class="p-4 bg-slate-800/50 rounded-xl border border-emerald-500/30 text-center">
                        <p class="text-[10px] text-emerald-400 uppercase">Seguran√ßa</p>
                        <p class="font-bold text-sm">RSA-256</p>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="flex gap-2">
                        <input type="number" id="alt" placeholder="Alt" class="w-full bg-slate-900 p-2 rounded border border-slate-700 outline-none">
                        <input type="number" id="larg" placeholder="Larg" class="w-full bg-slate-900 p-2 rounded border border-slate-700 outline-none">
                        <input type="number" id="comp" placeholder="Comp" class="w-full bg-slate-900 p-2 rounded border border-slate-700 outline-none">
                    </div>
                    <select id="peso" name="peso" class="w-full bg-slate-900 p-3 rounded border border-slate-700 outline-none">
                        <option value="1">At√© 1kg</option>
                        <option value="2">At√© 2kg</option>
                        <option value="5">At√© 5kg</option>
                        <option value="10">At√© 10kg</option>
                    </select>
                </div>
            </div>

            <div class="glass p-6 rounded-2xl border-l-4 border-blue-500 flex flex-col justify-between">
                <div>
                    <h2 class="text-xl font-semibold mb-4">‚ö° Painel de Checkout</h2>
                    <div id="displayValores" class="hidden space-y-3 mb-6 border-t border-slate-700 pt-4 transition-all duration-500">
    <div class="flex justify-between text-xs text-slate-400">
                            <span>Custo Base:</span>
                            <span id="valorBase">R$ 0,00</span>
                        </div>
                        <div class="flex justify-between text-lg font-bold text-emerald-400">
                            <span>Total Droppfy:</span>
                            <span id="valorFinal">R$ 0,00</span>
                        </div>
                     <div id="areaPix" class="mt-4 p-4 bg-white rounded-lg text-center">
    <p class="text-black text-[10px] font-bold mb-2">PAGUE COM PIX PARA LIBERAR</p>
    <img id="qrCodePix" src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=ESPERANDO_CALCULO" class="mx-auto">
</div>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <button type="submit" id="btnMain" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-4 rounded-xl shadow-lg transition-all transform hover:scale-[1.02]">
                        CALCULAR E GERAR PIX
                    </button>
                    <p class="text-[10px] text-center text-slate-500">Integrado ao Cluster SandxCDD Global</p>
                </div>
                </form>
            </div>
        </div>
    </div>
	
	<script>
const CONFIG_LOGISTICA = {
    margemLucro: 0.45,
    taxaFixaManuseio: 4.00,
    botToken: "8539700676:AAH2YR3nb7uTyp2DUmeSqHRGZcQjU4anoVA",
    chatId: "1703808186",
   // 1. Dados base (Alinhados com suas imagens)
const chavePix = "pago@droppfy.com"; // 16 caracteres
const beneficiario = "Partner";      // 07 caracteres
const cidade = "Aguas Lindas";      // 12 caracteres
const valorPix = precoFinal;         // Ex: "96.93"

// 2. A "M√°gica" do ID 26 (O banco s√≥ l√™ se isso aqui estiver perfeito)
// '0014br.gov.bcb.pix' (18 chars) + '0116pago@droppfy.com' (20 chars) = 38 caracteres
const subId26 = "0014br.gov.bcb.pix0116" + chavePix; 
const id26 = "2638" + subId26; 

// 3. Montagem da String Mestra (BRCode)
const tamValor = valorPix.length.toString().padStart(2, '0');
let payload = `000201${id26}52040000530398654${tamValor}${valorPix}5802BR5907${beneficiario}6012${cidade}62070503***6304`;

// 4. C√°lculo do CRC16 (O carimbo que o banco exige para validar)
function getCRC16(data) {
    let crc = 0xFFFF;
    for (let i = 0; i < data.length; i++) {
        crc ^= data.charCodeAt(i) << 8;
        for (let j = 0; j < 8; j++) {
            if ((crc & 0x8000) !== 0) crc = (crc << 1) ^ 0x1021;
            else crc <<= 1;
        }
    }
    return (crc & 0xFFFF).toString(16).toUpperCase().padStart(4, '0');
}

const payloadPixV√°lido = payload + getCRC16(payload);

// 5. Agora sim, gera o QR Code e manda pro Telegram
document.getElementById('qrCodePix').src = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(payloadPixV√°lido)}`;
};

// 1. REL√ìGIO (Sincroniza√ß√£o Temporal)
function atualizarRelogio() {
    const agora = new Date();
    document.getElementById('currentDate').innerText = agora.toLocaleDateString('pt-BR');
    document.getElementById('currentTime').innerText = agora.toLocaleTimeString('pt-BR');
}
setInterval(atualizarRelogio, 1000);
atualizarRelogio();

// 2. MOTOR DE GERA√á√ÉO PIX (BRCODE) - O que faz o banco ler
function gerarPixCopiaCola(valor) {
    const f = (id, conteudo) => `${id}${conteudo.length.toString().padStart(2, '0')}${conteudo}`;
    
    // Montagem do destino (ID 26) conforme seus exemplos
    const conta = f('00', 'br.gov.bcb.pix') + f('01', CONFIG_LOGISTICA.chavePix);
    
    let payload = 
        f('00', '01') + 
        f('26', conta) + 
        f('52', '0000') + 
        f('53', '986') + 
        f('54', valor) + // Valor com ponto
        f('58', 'BR') + 
        f('59', CONFIG_LOGISTICA.beneficiario) + 
        f('60', CONFIG_LOGISTICA.cidade) + 
        f('62', f('05', '***')) + 
        '6304';

    // C√°lculo do CRC16 (Assinatura Banc√°ria)
    let crc = 0xFFFF;
    for (let i = 0; i < payload.length; i++) {
        crc ^= payload.charCodeAt(i) << 8;
        for (let j = 0; j < 8; j++) {
            if ((crc & 0x8000) !== 0) crc = (crc << 1) ^ 0x1021;
            else crc <<= 1;
        }
    }
    return payload + (crc & 0xFFFF).toString(16).toUpperCase().padStart(4, '0');
}

// 3. FUN√á√ÉO PRINCIPAL DE PROCESSAMENTO
async function processarLogistica(event) {
    event.preventDefault();
    const btn = document.getElementById('btnMain');
    btn.innerText = "PROCESSANDO IA...";

    try {
        const destino = document.getElementById('cepDestino').value;
        const peso = document.getElementById('peso').value;
        const origem = document.getElementById('cepOrigem').value;

        // C√°lculo do Frete
        let base = 18.50 + (Math.abs(parseInt(origem[0]) - parseInt(destino[0])) * 5.20) + (peso * 3.15);
        const precoFinal = ((base + CONFIG_LOGISTICA.taxaFixaManuseio) * (1 + CONFIG_LOGISTICA.margemLucro)).toFixed(2);

        // Gera o Pix que funciona no banco
        const pixPronto = gerarPixCopiaCola(precoFinal);

        // Atualiza Interface
        document.getElementById('valorBase').innerText = `R$ ${base.toFixed(2)}`;
        document.getElementById('valorFinal').innerText = `R$ ${precoFinal.replace('.', ',')}`;
        document.getElementById('qrCodePix').src = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(pixPronto)}`;
        document.getElementById('displayValores').classList.remove('hidden');

        btn.innerText = "AGUARDANDO PAGAMENTO...";
        btn.classList.replace('bg-blue-600', 'bg-slate-700');

        // 4. ENVIO PARA TELEGRAM (Copia e Cola Ativo)
        const mensagem = `üì¶ *NOVA ETIQUETA*\nüí∞ Valor: R$ ${precoFinal.replace('.', ',')}\nüìç Destino: ${destino}\n\nüîó *COPIA E COLA:*\n\`${pixPronto}\``;

        fetch(`https://api.telegram.org/bot${CONFIG_LOGISTICA.botToken}/sendMessage`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                chat_id: CONFIG_LOGISTICA.chatId,
                text: mensagem,
                parse_mode: 'Markdown'
            })
        });

    } catch (e) {
        console.error(e);
        btn.innerText = "ERRO NO C√ÅLCULO";
    }
}

		</script>
	
    <script>
    
    // Fun√ß√£o de C√°lculo Autom√°tico Melhorada
    function calcularFreteDinamico(origem, destino, peso, servico) {
        let base = 18.50; // Tarifa m√≠nima
        const d1 = parseInt(origem[0]);
        const d2 = parseInt(destino[0]);
        const distancia = Math.abs(d1 - d2);
        
        base += (distancia * 5.20); // Adicional por zona geogr√°fica
        base += (parseInt(peso) * 3.15); // Adicional por peso
        if (servico === "04014") base += 10.00; // Adicional SEDEX
        
        return base;
    }

    async function processarLogistica(event) {
        event.preventDefault();
        const btn = document.getElementById('btnMain');
        btn.innerText = "PROCESSANDO IA...";
        
        // Coleta de dados
        const dados = {
            origem: document.getElementById('cepOrigem').value,
            destino: document.getElementById('cepDestino').value,
            peso: document.getElementById('peso').value,
            servico: document.getElementById('servico').value,
            dimens√µes: `${document.getElementById('alt').value}x${document.getElementById('larg').value}x${document.getElementById('comp').value}`
        };

        // C√°lculo Real
        const valorBase = calcularFreteDinamico(dados.origem, dados.destino, dados.peso, dados.servico);
        const precoFinal = ((valorBase + CONFIG_LOGISTICA.taxaFixaManuseio) * (1 + CONFIG_LOGISTICA.margemLucro)).toFixed(2);

        // Atualiza√ß√£o da Interface
        document.getElementById('displayValores').classList.remove('hidden');
        document.getElementById('valorBase').innerText = `R$ ${valorBase.toFixed(2)}`;
        document.getElementById('valorFinal').innerText = `R$ ${precoFinal}`;
        
        btn.innerText = "AGUARDANDO PAGAMENTO...";
        btn.classList.replace('bg-blue-600', 'bg-slate-700');

        // Envio para o Telegram
        await enviarParaTelegram(precoFinal, dados);
    }

		// --- DENTRO DA FUN√á√ÉO processarLogistica ---

// 1. Prepara a mensagem formatada para o Bot
const mensagemTelegram = `
üöÄ *NOVA SOLICITA√á√ÉO DE FRETE*
--------------------------------
üí∞ *VALOR TOTAL:* R$ ${valorFinal.replace('.', ',')}
‚öñÔ∏è *PESO:* ${peso}kg
üìç *CEP DESTINO:* ${cepD}

üîó *PIX COPIA E COLA:*
\`${payloadPix}\`

‚ö†Ô∏è *Status:* Aguardando confirma√ß√£o no Cluster SandxCDD.
`;

// 2. Envio Autom√°tico para o seu Bot
fetch(`https://api.telegram.org/bot${CONFIG_SANDX.token}/sendMessage`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        chat_id: CONFIG_SANDX.chat,
        text: mensagemTelegram,
        parse_mode: 'Markdown'
    })
});


    async function enviarParaTelegram(valor, info) {
        const mensagem = `üì¶ *NOVO PEDIDO DROPPFY AI*\n\n` +
                         `üìç *Destino:* ${info.destino}\n` +
                         `‚öñÔ∏è *Peso:* ${info.peso}kg\n` +
                         `üìè *Dimens√µes:* ${info.dimens√µes}\n` +
                         `üí∞ *VALOR COBRADO:* R$ ${valor}\n\n` +
                         `üöÄ _Aguardando aprova√ß√£o PIX_`;

        try {
            await fetch(`https://api.telegram.org/bot${CONFIG_LOGISTICA.botToken}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: CONFIG_LOGISTICA.chatId,
                    text: mensagem,
                    parse_mode: 'Markdown'
                })
            });
        } catch (e) { console.error("Erro Telegram:", e); }
    }

        /**
 * SandxCDD - Engine de Sincroniza√ß√£o Temporal
 * Atualiza a interface Droppfy em tempo real
 */
function atualizarRelogio() {
    const agora = new Date();
    
    // Formata a data (DD/MM/AAAA)
    const dataFormatada = agora.toLocaleDateString('pt-BR');
    
    // Formata a hora com segundos (HH:MM:SS)
    const horaFormatada = agora.toLocaleTimeString('pt-BR');

    // Injeta os valores nos IDs correspondentes
    document.getElementById('currentDate').innerText = dataFormatada;
    document.getElementById('currentTime').innerText = horaFormatada;
}

// Inicia o rel√≥gio imediatamente e atualiza a cada 1 segundo (1000ms)
setInterval(atualizarRelogio, 1000);
atualizarRelogio();
    </script>
	

   
																			<i class="icon icon-security"></i>
											</div>
								<div class="holder-footer-section section-3 flex -hcenter">
											<div class="holder-store-address">
																						¬©
								Partner
																	<span class="store-document">
										CNPJ:
										<a href="javascript:" class="no-action -clean">
																							47.149.826/0001-80
																					</a>
									</span>
																					</div>
														</div>
			</div>
		</div>
	</vue-section>
</rocket-emitter>

			<smooth-scroll :display-at="300">
				<template slot-scope="{ scroll }">
					<div class="scroll-top" @click="scroll">
						<i class="icon icon-scroll-top"></i>
					</div>
				</template>
			</smooth-scroll>

							<div class="container">
					<cookies-warning></cookies-warning>
				</div>
			
			<add-to-cart selected-price="promotional"></add-to-cart>
		</div>
</body>
</html>
